(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{17:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(19),i=n.n(o),s=n(8),r=(n(17),n(24)),l=n(2),u=n.p+"static/media/logo.c7581985.svg",p=n(0);function d(e){return Object(p.jsxs)("header",{className:"header",children:[Object(p.jsx)("img",{className:"logo",src:u,alt:"Around The U.S. logo"}),Object(p.jsxs)("div",{className:"header__nav-container",children:[Object(p.jsx)("p",{className:"header__email",children:e.email}),Object(p.jsx)(s.b,{className:"header__link",to:e.linkPath?e.linkPath:"/signin",onClick:e.email?function(t){t.preventDefault(),e.onSignOut()}:null,children:e.buttonTitle})]})]})}var j=c.a.createContext();function h(e){var t=c.a.useContext(j),n=e.card.owner._id===t._id,a="element__delete ".concat(n?" element__delete_visible":"element__delete_hidden");var o=e.card.likes.some((function(e){return e._id===t._id})),i="".concat(o?"heart-button heart-button_active":"heart-button");return Object(p.jsxs)("div",{className:"element",children:[Object(p.jsx)("button",{className:a,type:"button",name:"element-delete-button",onClick:function(){e.onCardDelete(e.card)}}),Object(p.jsx)("img",{className:"element__img",src:"".concat(e.card.link),alt:"".concat(e.card.name),onClick:function(){e.onCardClick(e.card)}}),Object(p.jsxs)("div",{className:"element__container",children:[Object(p.jsx)("h2",{className:"element__container-heading",children:"".concat(e.card.name)}),Object(p.jsxs)("div",{className:"element__container-heartbutton",children:[Object(p.jsx)("button",{className:i,type:"button",name:"heart-button",onClick:function(){e.onCardLike(e.card)}}),Object(p.jsx)("p",{className:"image-likes",children:"".concat(e.card.likes.length)})]})]})]})}function m(e){var t=c.a.useContext(j);return Object(p.jsxs)("main",{className:"main",children:[Object(p.jsxs)("section",{className:"profile",children:[Object(p.jsxs)("div",{className:"profile__container",children:[Object(p.jsxs)("div",{className:"profile__avatar-container",children:[Object(p.jsx)("img",{src:"".concat(t.avatar),className:"profile__avatar",alt:"Avatar that describe the user"}),Object(p.jsx)("div",{className:"profile__avatar-overlay",onClick:e.onEditAvatarClick})]}),Object(p.jsxs)("div",{className:"profile__info",children:[Object(p.jsxs)("div",{className:"profile__info-heading-container",children:[Object(p.jsx)("h1",{className:"profile__info-heading",children:"".concat(t.name)}),Object(p.jsx)("button",{type:"button",className:"profile__info-edit hover",onClick:e.onEditProfileClick})]}),Object(p.jsx)("p",{className:"profile__info-description",children:"".concat(t.about)})]})]}),Object(p.jsx)("button",{type:"button",className:"profile__add-button hover",onClick:e.onAddPlaceClick})]}),Object(p.jsx)("section",{className:"elements",children:e.cards.map((function(t){return Object(p.jsx)(h,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},t._id)}))})]})}function b(){return Object(p.jsx)("footer",{className:"footer",children:Object(p.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Around The U.S."})})}function f(e){return Object(p.jsx)("div",{className:"popup popup-".concat(e.name," ").concat(e.isOpen?"popup_open":""),children:Object(p.jsxs)("div",{className:"popup-".concat(e.name,"__container"),children:[Object(p.jsx)("button",{onClick:e.onClose,className:"popup__close hover",type:"button"}),Object(p.jsxs)("form",{onSubmit:e.onSubmit,className:"popup__form",name:"popup-".concat(e.name,"-form"),id:"popup-".concat(e.name,"__form"),children:[Object(p.jsx)("h2",{className:"popup-".concat(e.name,"__form-heading"),children:"".concat(e.title)}),e.children,Object(p.jsx)("button",{className:"popup__button",type:"submit",children:e.buttonText})]})]})})}function _(e){return Object(p.jsx)("div",{className:"popup popup popup-image ".concat(e.isOpen?"popup_open":""),children:Object(p.jsxs)("div",{className:"popup-image__container",children:[Object(p.jsx)("button",{onClick:e.onClose,className:"popup__close hover",type:"button"}),Object(p.jsx)("img",{className:"popup-image__image",src:"".concat(e.card.link),alt:"".concat(e.card.name)}),Object(p.jsx)("h2",{className:"popup-image__name",children:"".concat(e.card.name)})]})})}var O=n(3),g=n(21),v=n(22),x=n(25),C=n(23),N=new(function(e){Object(x.a)(n,e);var t=Object(C.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).baseUrl=e.baseUrl,a.headers=e.headers,a}return Object(v.a)(n,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getInitialCards",value:function(e){var t=this;return fetch("".concat(this.baseUrl,"/cards"),{headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then((function(e){return t._getResponseData(e)}))}},{key:"getUserInfo",value:function(e){var t=this;return fetch("".concat(this.baseUrl,"/users/me"),{headers:{authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}).then((function(e){return t._getResponseData(e)}))}},{key:"changeLikeCardStatus",value:function(e,t,n){var a=this;return t?fetch("".concat(this.baseUrl,"/cards/").concat(e,"/likes"),{method:"PUT",headers:{authorization:"Bearer ".concat(n),"Content-Type":"application/json"}}).then((function(e){return a._getResponseData(e)})):t?void 0:fetch("".concat(this.baseUrl,"/cards/").concat(e,"/likes"),{method:"DELETE",headers:{authorization:"Bearer ".concat(n),"Content-Type":"application/json"}}).then((function(e){return a._getResponseData(e)}))}},{key:"removeCard",value:function(e,t){var n=this;return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:{authorization:"Bearer ".concat(t),"Content-Type":"application/json"}}).then((function(e){return n._getResponseData(e)}))}},{key:"setUserInfo",value:function(e,t,n){var a=this;return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((function(e){return a._getResponseData(e)}))}},{key:"setAvatarImage",value:function(e,t){var n=this;return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:{authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({avatar:"".concat(e)})}).then((function(e){return n._getResponseData(e)}))}},{key:"addNewCard",value:function(e,t,n){var a=this;return console.log(e),fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:{authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((function(e){return a._getResponseData(e)}))}},{key:"getAllInfo",value:function(e){return Promise.all([this.getUserInfo(e),this.getInitialCards(e)])}}]),n}(c.a.Component))({baseUrl:"http://localhost:3000"});function k(e){var t=c.a.useContext(j),n=Object(a.useState)(t.name),o=Object(l.a)(n,2),i=o[0],s=o[1],r=Object(a.useState)(t.about),u=Object(l.a)(r,2),d=u[0],h=u[1];return c.a.useEffect((function(){s(t.name),h(t.about)}),[t,e.isOpen]),Object(p.jsxs)(f,{name:"profile",title:"Edit profile",isOpen:e.isOpen,onClose:e.onClose,buttonText:"Save",onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:i,about:d})},children:[Object(p.jsx)("input",{name:"popup-profile-profile-name-input",className:"popup__input",id:"popup-profile__form-input_name",type:"text",placeholder:"Jacques Cousteau",required:!0,value:i||"",minLength:"2",maxLength:"40",onChange:function(e){s(e.target.value)}}),Object(p.jsx)("span",{id:"popup-profile__form-input_name-error",className:"popup__error"}),Object(p.jsx)("input",{id:"popup-profile__form-input_job",name:"popup-profile-job-input",className:"popup__input",type:"text",placeholder:"Explorer",required:!0,value:d||"",minLength:"2",maxLength:"200",onChange:function(e){h(e.target.value)}}),Object(p.jsx)("span",{id:"popup-profile__form-input_job-error",className:"popup__error"})]})}function y(e){var t=Object(a.useRef)(null);return Object(p.jsxs)(f,{name:"avataredit",title:"Change profile picture",isOpen:e.isOpen,onClose:e.onClose,buttonText:"Save",onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:[Object(p.jsx)("input",{name:"popup-avataredit-profile-link-input",className:"popup__input",id:"popup-avataredit__form-input_link",type:"url",placeholder:"Jacques Cousteau",required:!0,minLength:"2",ref:t}),Object(p.jsx)("span",{id:"popup-avataredit__form-input_link-error",className:"popup__error"})]})}function S(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)(""),r=Object(l.a)(s,2),u=r[0],d=r[1];return c.a.useEffect((function(){i(""),d("")}),[e.isOpen]),Object(p.jsxs)(f,{name:"card",title:"New place",isOpen:e.isOpen,onClose:e.onClose,buttonText:"Create",onSubmit:function(t){t.preventDefault(),e.onNewCard({name:o,link:u})},children:[Object(p.jsx)("input",{name:"popup-card-title-input",className:"popup__input",id:"popup-card__form-input_title",type:"text",placeholder:"Title",required:!0,value:o||"",minLength:"1",maxLength:"30",onChange:function(e){i(e.target.value)}}),Object(p.jsx)("span",{id:"popup-card__form-input_title-error",className:"popup__error"}),Object(p.jsx)("input",{id:"popup-card__form-input_imgurl",name:"popup-card-imgurl-input",className:"popup__input",type:"url",value:u||"",placeholder:"Image link",required:!0,onChange:function(e){d(e.target.value)}}),Object(p.jsx)("span",{id:"popup-card__form-input_imgurl-error",className:"popup__error"})]})}var T=function(e){return Object(p.jsx)(O.b,{children:e.loggedIn?e.children:Object(p.jsx)(O.a,{to:e.redirectTo})})};function w(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)(""),r=Object(l.a)(i,2),u=r[0],d=r[1];return Object(p.jsx)("main",{className:"main",children:Object(p.jsxs)("div",{className:"login",children:[Object(p.jsx)("h1",{className:"login__welcome",children:"Log in"}),Object(p.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.handleLogin({email:c,password:u})},className:"login__form",children:[Object(p.jsx)("input",{className:"login__input",placeholder:"Email",id:"email",required:!0,name:"email",type:"email",pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$",value:c,onChange:function(e){return o(e.target.value)}}),Object(p.jsx)("input",{className:"login__input",placeholder:"Password",id:"password",required:!0,name:"password",type:"password",value:u,onChange:function(e){return d(e.target.value)}}),Object(p.jsx)("div",{className:"login__button-container",children:Object(p.jsx)("button",{type:"submit",className:"login__link",children:"Log in"})})]}),Object(p.jsxs)("div",{className:"login__signup",children:[Object(p.jsx)("p",{children:"Not a member yet?"}),Object(p.jsx)(s.b,{to:"/signup",className:"signup__link",children:"Sign up here!"})]})]})})}function U(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)(""),r=Object(l.a)(i,2),u=r[0],d=r[1];return Object(p.jsx)("main",{className:"main",children:Object(p.jsxs)("div",{className:"register",children:[Object(p.jsx)("h1",{className:"register__welcome",children:"Sign up"}),Object(p.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.handleRegister({email:c,password:u})},className:"register__form",children:[Object(p.jsx)("input",{className:"register__input",placeholder:"Email",id:"email",required:!0,name:"email",type:"email",pattern:"[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,}$",value:c,onChange:function(e){return o(e.target.value)}}),Object(p.jsx)("input",{className:"register__input",placeholder:"Password",id:"password",required:!0,name:"password",type:"password",value:u,onChange:function(e){return d(e.target.value)}}),Object(p.jsx)("div",{className:"register__button-container",children:Object(p.jsx)("button",{type:"submit",className:"register__button",children:"Sign up"})})]}),Object(p.jsxs)("div",{className:"register__signup",children:[Object(p.jsx)("p",{children:"Already a member? "}),Object(p.jsx)(s.b,{to:"/signin",className:"register__signup_link",children:"Log in here!"})]})]})})}var I=function(e){return Object(p.jsx)("div",{className:"popup popup popup-image ".concat(e.isOpen?"popup_open":""),children:Object(p.jsxs)("div",{className:"InfoTooltip__container",children:[Object(p.jsx)("button",{onClick:e.onClose,className:"popup__close hover",type:"button"}),Object(p.jsx)("div",{className:e.isSuccsess?"InfoTooltip__success":"InfoTooltip__unsuccess"}),Object(p.jsx)("h2",{className:"InfoTooltip__title",children:e.isSuccsess?"Success! You have now been registered.":"Oops, something went wrong! Please try again."})]})})},P="http://localhost:3000",D=function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))};var E=function(){var e=Object(a.useState)({}),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)([]),s=Object(l.a)(i,2),u=s[0],h=s[1],g=Object(a.useState)({}),v=Object(l.a)(g,2),x=v[0],C=v[1],E=Object(a.useState)(!1),L=Object(l.a)(E,2),A=L[0],z=L[1],R=Object(a.useState)(""),q=Object(l.a)(R,2),B=q[0],J=q[1],F=Object(O.g)(),H=localStorage.getItem("jwt");c.a.useEffect((function(){var e;H&&(e=H,fetch("".concat(P,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return D(e)}))).then((function(e){e&&(z(!0),F.push("/"),J(e.email))})).catch((function(e){return console.log(e)}))}),[H,F]),c.a.useEffect((function(){N.getAllInfo(H).then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];o(n),h(a)})).catch((function(e){console.log(e)}))}),[H]);var Y=Object(a.useState)(!1),$=Object(l.a)(Y,2),G=$[0],M=$[1],K=Object(a.useState)(!1),Q=Object(l.a)(K,2),V=Q[0],W=Q[1],X=Object(a.useState)(!1),Z=Object(l.a)(X,2),ee=Z[0],te=Z[1],ne=Object(a.useState)(!1),ae=Object(l.a)(ne,2),ce=ae[0],oe=ae[1],ie=Object(a.useState)(!1),se=Object(l.a)(ie,2),re=se[0],le=se[1],ue=Object(a.useState)(!1),pe=Object(l.a)(ue,2),de=pe[0],je=pe[1];function he(){M(!1),te(!1),W(!1),oe(!1),C({}),le(!1)}return Object(p.jsx)("div",{className:"page",children:Object(p.jsxs)("div",{className:"page__container",children:[Object(p.jsx)(I,{isOpen:re,onClose:he,isSuccsess:de}),Object(p.jsxs)(O.d,{children:[Object(p.jsxs)(O.b,{path:"/signin",children:[Object(p.jsx)(d,{buttonTitle:"Sign Up",linkPath:"/signup"}),Object(p.jsx)(w,{handleLogin:function(e){var t,n;(t=e.password,n=e.email,fetch("".concat(P,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({password:t,email:n})}).then((function(e){return D(e)}))).then((function(t){t.token&&(localStorage.setItem("jwt",t.token),J(e.email),z(!0),F.push("/"))})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(b,{})]}),Object(p.jsxs)(O.b,{path:"/signup",children:[Object(p.jsx)(d,{buttonTitle:"Sign In",linkPath:"/signin"}),Object(p.jsx)(U,{handleRegister:function(e){var t,n;(t=e.email,n=e.password,fetch("".concat(P,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then((function(e){return D(e)}))).then((function(){je(!0)})).catch((function(e){console.log(e),je(!1)})).finally((function(){return le(!0)}))}}),Object(p.jsx)(b,{})]}),Object(p.jsx)(T,{strict:!0,path:"/",loggedIn:A,redirectTo:"/signin",children:Object(p.jsxs)(j.Provider,{value:n,children:[Object(p.jsx)(k,{isOpen:G,onClose:he,onUpdateUser:function(e){N.setUserInfo(e.name,e.about,H).then((function(e){o(e),he()})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(y,{isOpen:ee,onClose:he,onUpdateAvatar:function(e){N.setAvatarImage(e.avatar,H).then((function(e){o(e),he()})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(S,{isOpen:V,onClose:he,onNewCard:function(e){N.addNewCard(e.name,e.link,H).then((function(e){console.log(e),h([e].concat(Object(r.a)(u))),he()})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(f,{name:"delete",title:"Are you sure?",buttonText:"Yes"}),Object(p.jsx)(_,{isOpen:ce,onClose:he,card:x}),Object(p.jsx)(d,{email:B,buttonTitle:"Sign out",onSignOut:function(e){localStorage.removeItem("jwt"),F.push("/signin")}}),Object(p.jsx)(m,{onEditProfileClick:function(){M(!0)},onAddPlaceClick:function(){W(!0)},onEditAvatarClick:function(){te(!0)},onCardClick:function(e){C(e),oe(!0)},cards:u,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===n._id}));N.changeLikeCardStatus(e._id,!t,H).then((function(t){h((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){e.owner._id===n._id&&N.removeCard(e._id,H).then((function(){var t=u.filter((function(t){return!(t._id===e._id)}));h(t)})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(b,{})]})})]})]})})},L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),o(e),i(e)}))};i.a.render(Object(p.jsx)(s.a,{children:Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(E,{})})}),document.getElementById("root")),L()}},[[36,1,2]]]);
//# sourceMappingURL=main.e9e91763.chunk.js.map